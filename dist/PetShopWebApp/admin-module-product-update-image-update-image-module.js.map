{"version":3,"sources":["./src/app/admin/module/product/update-image/update-image.component.ts","./src/app/admin/module/product/update-image/update-image.component.html","./src/app/admin/module/product/update-image/update-image-routing.module.ts","./src/app/admin/module/product/update-image/update-image.module.ts"],"names":[],"mappings":"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","file":"admin-module-product-update-image-update-image-module.js","sourcesContent":["import { HttpResponse } from '@angular/common/http';\nimport { Component, OnInit } from '@angular/core';\nimport { FormBuilder, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { ProductDTO } from 'src/app/dto/product-dto';\nimport { ProductImage } from 'src/app/model/product-image';\nimport { MessageResponse } from 'src/app/response/message-response';\nimport { ProductService } from 'src/app/service/product.service';\nimport Swal from 'sweetalert2';\n\n@Component({\n  selector: 'app-update-image',\n  templateUrl: './update-image.component.html',\n  styleUrls: ['./update-image.component.css']\n})\nexport class UpdateImageComponent implements OnInit {\n\n  productDTO:ProductDTO | null = null;\n  productImages?: ProductImage[];\n\n  submitted = false;\n  message?:string;\n\n  selectedFiles?: FileList;\n  files:any[] = [];\n  imgURLs:any[] = [];\n\n  myForm = this.formBuilder.group({\n    id: ['', [Validators.required]],\n  });\n\n  constructor(\n    protected productService: ProductService,\n    private route: ActivatedRoute,\n    private formBuilder: FormBuilder,\n    private router:Router \n  ) { }\n\n  ngOnInit(): void {\n    this.findById(this.route.snapshot.params.id);\n  }\n\n  findById(id:any): void {\n    this.productService.view(id).subscribe(\n      (res:HttpResponse<ProductDTO>) => {\n        this.productDTO = res.body;\n        if(this.productDTO) {\n          this.updateForm(this.productDTO);\n        }\n\n        this.productImages = this.productDTO?.productImages;\n      }\n    );\n  }\n\n  selectFile(event: any): void {\n    this.selectedFiles = event.target.files;\n   \n    if(this.selectedFiles) {\n      if(this.files.length + this.selectedFiles?.length > 3) {\n        Swal.fire('Thông báo', 'Bạn chỉ được chọn tối đa 3 bức ảnh', 'warning');\n      } else {\n        for(let i = 0; i < this.selectedFiles.length; i++) {\n          let file: File | null = this.selectedFiles.item(i);\n          \n          if(file) {\n            this.files?.push(file);\n  \n            const reader = new FileReader();\n            reader.readAsDataURL(file);\n            reader.onload = () => {\n             this.imgURLs?.push({base64String: reader.result})\n            };\n          }\n        }\n      }\n    }\n  }\n\n  deleteImage(i:any): void {\n      this.imgURLs?.forEach((item, index) => {\n        if (index === i) {\n          this.imgURLs.splice(index, 1);\n          this.files.splice(index, 1);\n        }\n      });\n  }\n\n  get f() {\n    return this.myForm.controls;\n  }\n\n  updateForm(productDTO: ProductDTO): void {\n    this.myForm.patchValue({\n      id: productDTO.id\n    });\n  }\n\n  onSubmit(): void {\n    this.submitted = true;\n\n    if (this.myForm.invalid) {\n      return;\n    }\n\n    const formData: FormData = new FormData();\n\n    if (this.files.length === 0) {\n      Swal.fire('Thông báo', 'Bạn phải chọn ít nhất 1 bước ảnh cho sản phẩm', 'error');\n    } else {\n      this.files?.forEach((item, index) => {\n        formData.append('files', item);\n      });\n      formData.append('id', JSON.stringify(this.myForm.value.id));\n      \n      console.log(this.myForm.value.id);\n      this.productService.updateImage(formData).subscribe(\n        (response: HttpResponse<MessageResponse>) => {\n          this.message = response.body?.message;\n\n          if(this.message === 'success') {\n            Swal.fire('Thông báo', 'Cập nhật ảnh sản phẩm thành công', 'success');\n            this.router.navigate(['home-admin/list-product']);\n          } else if(this.message === 'failed') {\n            Swal.fire('Thông báo', 'Cập nhật sản phẩm không thành công', 'error');\n          }\n        }\n      )\n      }\n  }\n\n  onBack(): void {\n    window.history.back();\n  }\n\n}\n","<div class=\"row justify-content-center mt-2 mb-2\">\n    <div class=\"col-12\" *ngIf=\"productDTO\">\n        <h3 style=\"color: grey;\">CẬP NHẬT ẢNH CHO SẢN PHẨM</h3>\n        <div id=\"carouselExampleControlsNoTouching\" class=\"carousel slide\" data-bs-touch=\"false\" data-bs-interval=\"false\">\n            <div class=\"carousel-inner\">\n                <div [ngClass]=\"i===0 ? 'carousel-item active' : 'carousel-item'\" *ngFor=\"let url of productImages; let i = index\">\n                    <img [src]=\"url.image\" class=\"d-block w-100 image-detail\">\n                </div>\n            </div>\n            <button class=\"carousel-control-prev\" type=\"button\" data-bs-target=\"#carouselExampleControlsNoTouching\" data-bs-slide=\"prev\">\n              <span class=\"carousel-control-prev-icon\" aria-hidden=\"true\"></span>\n              <span class=\"visually-hidden\">Previous</span>\n            </button>\n            <button class=\"carousel-control-next\" type=\"button\" data-bs-target=\"#carouselExampleControlsNoTouching\" data-bs-slide=\"next\">\n              <span class=\"carousel-control-next-icon\" aria-hidden=\"true\"></span>\n              <span class=\"visually-hidden\">Next</span>\n            </button>\n        </div>\n    </div>\n</div>\n\n<form class=\"col-sm-5 mb-2\" (ngSubmit)=\"onSubmit()\" [formGroup]=\"myForm\">\n    <div class=\"mb-3\" [hidden]=\"true\">\n        <input type=\"text\" class=\"form-control\" formControlName=\"id\">\n    </div>\n\n    <div class=\"mb-3\">\n        <label for=\"image\" class=\"form-label\">Chọn ảnh</label>\n        <input type=\"file\" class=\"form-control\" accept=\"image/*\" (change)=\"selectFile($event)\" multiple=\"true\">\n    </div>\n\n    <div class=\"mb-3 text-center\" *ngIf=\"imgURLs && imgURLs.length > 0\">\n        <div *ngFor=\"let url of imgURLs; let i = index\">\n            <img [src]=\"url.base64String\" class=\"image-proudct\"><button type=\"button\" class=\"btn btn-danger\" (click)=\"deleteImage(i)\"><i class=\"bi bi-trash-fill\"></i> Xóa</button>\n        </div>\n    </div>\n\n    <button type=\"submit\" class=\"btn btn-primary\">Lưu</button>\n    <button type=\"button\" class=\"btn btn-secondary ms-2 ml-1\" (click)=\"onBack()\">Quay lại</button>\n</form>","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { UpdateImageComponent } from './update-image.component';\n\nconst routes: Routes = [{ path: '', component: UpdateImageComponent }];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class UpdateImageRoutingModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { UpdateImageRoutingModule } from './update-image-routing.module';\nimport { UpdateImageComponent } from './update-image.component';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\n\n@NgModule({\n  declarations: [UpdateImageComponent],\n  imports: [\n    CommonModule,\n    UpdateImageRoutingModule,\n    FormsModule, \n    ReactiveFormsModule\n  ]\n})\nexport class UpdateImageModule { }\n"],"sourceRoot":"webpack:///"}